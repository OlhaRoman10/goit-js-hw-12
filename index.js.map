{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\nconst API_KEY = \"49321124-d9248d4be3ea0dc21aad93268\";\nconst BASE_URL = \"https://pixabay.com/api/\";\n\nexport async function fetchImages(query, page) {\n        try {\n        const response = await axios.get(BASE_URL, {\n            params: {\n                key: API_KEY,\n                q: query,\n                image_type: \"photo\",\n                orientation: \"horizontal\",\n                safesearch: true,\n                per_page: 15,\n                page: page, // Передаємо поточну сторінку\n            }\n        });\n \n        return { images: response.data.hits || [],\n            totalHits: response.data.totalHits || 0\n        };\n    } catch (error) {\n        console.error(\"Error fetching images:\", error);\n        return { images: [], totalHits: 0 };\n    }\n}\n            \n      \n\n\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst gallery = document.querySelector(\".gallery\");\nlet lightbox = null; // Зберігаємо lightbox для оновлення\n\nexport function renderGallery(images, append = false) {\n  try {\n    if (!append) {\n      gallery.innerHTML = \"\"; // Очищаємо галерею тільки при новому пошуку\n    }\n\n    const markup = images.map(image => `\n      <li class=\"gallery-item\">\n        <a href=\"${image.largeImageURL}\" class=\"gallery-link\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\">\n        </a>\n        <div class=\"info\">\n          <p><span class=\"matter\">Likes:</span> ${image.likes}</p>\n          <p><span class=\"matter\">Views:</span> ${image.views}</p>\n          <p><span class=\"matter\">Comments:</span> ${image.comments}</p>\n          <p><span class=\"matter\">Downloads:</span> ${image.downloads}</p>\n        </div>\n      </li>\n    `).join(\"\");\n\n    gallery.insertAdjacentHTML(\"beforeend\", markup); // Додаємо нові зображення\n\n    if (!lightbox) {\n      lightbox = new SimpleLightbox(\".gallery a\", {\n        captionsData: \"alt\",\n        captionDelay: 250\n      });\n    } else {\n      lightbox.refresh(); // Оновлюємо lightbox при додаванні нових картинок\n    }\n  } catch (error) {\n    console.error(\"Error rendering gallery:\", error);\n  }\n}\n","import { fetchImages } from \"./js/pixabay-api.js\";\nimport { renderGallery } from \"./js/render-functions.js\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst form = document.querySelector(\".form\");\nconst loader = document.querySelector(\".loader\");\nconst input = form.querySelector(\"input[name='search-text']\");\nconst gallery = document.querySelector(\".gallery\");\nconst loadMoreBtn = document.querySelector(\".btn\");\n\nlet totalHits = 0; // Загальна кількість знайдених зображень\nlet loadedImages = 0; // Кількість вже завантажених зображень\nlet currentQuery = \"\"; // Змінна для збереження поточного запиту\nlet page = 1; // Сторінка запиту\n\nloader.classList.add(\"hidden\");\nloadMoreBtn.classList.add(\"hidden\"); // Ховаємо кнопку \"Load more\" на старті\n\nfunction showLoader() {\n  loader.classList.remove(\"hidden\");\n}\n\nfunction hideLoader() {\n  loader.classList.add(\"hidden\");\n}\n\nfunction showLoadMoreBtn() {\n  loadMoreBtn.classList.remove(\"hidden\");\n}\n\nfunction hideLoadMoreBtn() {\n  loadMoreBtn.classList.add(\"hidden\");\n}\n\nfunction smoothScroll() {\n  const cardHeight = document.querySelector(\".gallery-item\")?.getBoundingClientRect().height || 0;\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: \"smooth\",\n  });\n}\n\nform.addEventListener(\"submit\", async (event) => {\n  event.preventDefault();\n  const query = input.value.trim();\n\n  if (!query) {\n    iziToast.error({ message: \"Please enter a search query!\" });\n    return;\n  }\n\n  if (query !== currentQuery) {\n    currentQuery = query;\n    loadedImages = 0; // Скидаємо кількість завантажених зображень для нового запиту\n    page = 1; // Скидаємо номер сторінки для нового запиту\n  }\n\n  gallery.innerHTML = \"\"; // Очищаємо галерею перед новим пошуком\n  hideLoadMoreBtn(); // Ховаємо кнопку \"Load more\" перед новим пошуком\n  showLoader();\n\n  try {\n    const response = await fetchImages(currentQuery, page);\n    if (!response || !response.hits) throw new Error(\"Invalid response from API\");\n\n    const images = response.hits;\n    totalHits = response.totalHits; // Оновлюємо загальну кількість знайдених зображень\n    loadedImages = images.length; // Оновлюємо кількість завантажених зображень\n\n    if (images.length === 0) {\n      iziToast.error({\n        message: \"Sorry, there are no images matching your search query. Please try again!\",\n        position: \"topRight\",\n      });\n    } else {\n      renderGallery(images);\n\n      // Показуємо кнопку \"Load more\", якщо є ще зображення для завантаження\n      if (loadedImages < totalHits) {\n        showLoadMoreBtn();\n      }\n    }\n  } catch (error) {\n    iziToast.error({ message: \"Something went wrong. Please try again later.\" });\n  } finally {\n    hideLoader();\n  }\n});\n\nloadMoreBtn.addEventListener(\"click\", async () => {\n  showLoader(); // Показуємо loader під час завантаження нової сторінки\n  page += 1; // Збільшуємо номер сторінки перед новим запитом\n\n  try {\n    const response = await fetchImages(currentQuery, page);\n    if (!response || !response.hits) throw new Error(\"Invalid response from API\");\n\n    const images = response.hits;\n    loadedImages += images.length; // Додаємо кількість завантажених зображень\n\n    if (images.length === 0 || loadedImages >= totalHits) {\n      iziToast.info({ message: \"We're sorry, but you've reached the end of search results.\" });\n      hideLoadMoreBtn(); // Ховаємо кнопку, якщо більше немає зображень\n    } else {\n      renderGallery(images, true); // Додаємо нові зображення до галереї\n      smoothScroll(); // Плавний скрол після завантаження нових зображень\n    }\n  } catch (error) {\n    iziToast.error({ message: \"Something went wrong. Please try again later.\" });\n  } finally {\n    hideLoader(); // Завжди ховаємо loader після завантаження\n  }\n});\n"],"names":["API_KEY","BASE_URL","fetchImages","query","page","response","axios","error","gallery","lightbox","renderGallery","images","append","markup","image","SimpleLightbox","form","loader","input","loadMoreBtn","totalHits","loadedImages","currentQuery","showLoader","hideLoader","showLoadMoreBtn","hideLoadMoreBtn","smoothScroll","cardHeight","_a","event","iziToast"],"mappings":"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"}