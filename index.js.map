{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\nconst API_KEY = \"49321124-d9248d4be3ea0dc21aad93268\";\nconst BASE_URL = \"https://pixabay.com/api/\";\n\nlet page = 1;\nlet currentQuery = \"\"; // Глобальна змінна для збереження запиту\nlet totalHits = 0;\n\nexport async function fetchImages(query, isNewSearch = false) {\n    if (isNewSearch) {\n        page = 1; // Якщо новий пошук — скидаємо сторінку\n        currentQuery = query; // Оновлюємо збережений запит\n         totalHits = 0; // Скидаємо загальну кількість результатів\n    }\n    try {\n        const response = await axios.get(BASE_URL, {\n            params: {\n                key: API_KEY,\n                q: query,\n                image_type: \"photo\",\n                orientation: \"horizontal\",\n                safesearch: true,\n                per_page: 15,\n                page: page, // Передаємо поточну сторінку\n            }\n        });\n if (isNewSearch) {\n            totalHits = response.data.totalHits; // Отримуємо загальну кількість зображень\n        }\n\n if (response.data.hits.length > 0) {\n page += 1; // Збільшуємо сторінку тільки якщо отримали результати\n        }    \n        return { images:response.data.hits, totalHits }; //не дуже тут зрозуміла\n    } catch (error) {\n        console.error(\"Error fetching images:\", error);\n        return { images: [], totalHits: 0 };\n    }\n}\n            \n      \n\n\n","import axios from \"axios\";\nimport SimpleLightbox from \"simplelightbox\";\n// Додатковий імпорт стилів\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nexport async function renderGallery(images) {\n  const gallery = document.querySelector(\".gallery\");\n  try {\n    gallery.innerHTML = \"\";\n        \n    gallery.innerHTML = images.map(image => `\n    <li class=\"gallery-item\">\n      <a href=\"${image.largeImageURL}\" class=\"gallery-link\">\n        <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\">\n      </a>\n      <div class=\"info\">\n        <p><span class=\"matter\">Likes</span> ${image.likes}</p>\n        <p><span class=\"matter\">Views</span> ${image.views}</p>\n        <p><span class=\"matter\">Comments</span> ${image.comments}</p>\n        <p><span class=\"matter\">Downloads</span> ${image.downloads}</p>\n      </div>\n    </li>\n  `).join(\"\");\n    const lightbox = new SimpleLightbox(\".gallery a\", {\n      captionsData: \"alt\",\n      captionDelay: 250\n    });\n\n    lightbox.refresh();\n } catch (error) {\n    console.error(\"Error rendering gallery:\", error);\n  }\n}","import { fetchImages } from \"./js/pixabay-api.js\";\nimport { renderGallery } from \"./js/render-functions.js\"\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst form = document.querySelector(\".form\");\nconst loader = document.querySelector(\".loader\");\nconst input = form.querySelector(\"input[name='search-text']\");\nconst gallery = document.querySelector(\".gallery\");\nconst loadMoreBtn = document.querySelector(\".btn\");\n\nlet totalHits = 0; // Загальна кількість знайдених зображень\nlet loadedImages = 0; // Кількість вже завантажених зображень\n\nloader.classList.add(\"hidden\");\nloadMoreBtn.classList.add(\"hidden\"); // Ховаємо кнопку \"Load more\" на старті\n\nfunction showLoader() {\n  loader.classList.remove(\"hidden\");\n}\n\nfunction hideLoader() {\n  loader.classList.add(\"hidden\");\n}\n\nfunction showLoadMoreBtn() {\n  loadMoreBtn.classList.remove(\"hidden\");\n}\n\nfunction hideLoadMoreBtn() {\n  loadMoreBtn.classList.add(\"hidden\");\n}\n\nform.addEventListener(\"submit\", async (event) => {\n    event.preventDefault();\n    const query = input.value.trim();\n\n        if (!query) {\n        iziToast.error({ message: \"Please enter a search query!\" })\n        return;\n    }\n    gallery.innerHTML = \"\"; // Очищаємо галерею перед новим пошуком\n    hideLoadMoreBtn(); // Ховаємо кнопку \"Load more\" перед новим пошуком\n    showLoader();\n\n    try {\n        const response = await fetchImages(query, true);\n        if (!response || !response.images) throw new Error(\"Invalid response from API\");\n\n    const { images, totalHits: newTotalHits } = response;\n        totalHits = newTotalHits; // Оновлюємо загальну кількість знайдених зображень\n        loadedImages = images.length; // Оновлюємо кількість завантажених зображень\n        \n        if (images.length === 0) {\n            iziToast.error({\n                message: \"Sorry, there are no images matching your search query. Please try again!\", position: \"topRight\",\n            });\n        } else {\n            renderGallery(images);\n            if (loadedImages < totalHits) {\n        showLoadMoreBtn(); // Показуємо кнопку \"Load more\", якщо є ще зображення\n            }\n        }\n    } catch (error) {\n        iziToast.error({ message: \"Something went wrong. Please try again later.\" });\n    } finally {\n        hideLoader();\n    }\n});\n\nloadMoreBtn.addEventListener(\"click\", async () => {\n  showLoader(); // Показуємо loader під час завантаження нової сторінки\n        \n  try {\n      const response = await fetchImages(input.value.trim());\n    if (!response || !response.images) throw new Error(\"Invalid response from API\");\n\n      const { images } = response;\n      loadedImages += images.length; // Додаємо кількість завантажених зображень\n    \n    if (images.length === 0 || loadedImages >= totalHits) {\n      iziToast.info({ message: \"We're sorry, but you've reached the end of search results.\" });\n      hideLoadMoreBtn(); // Ховаємо кнопку, якщо більше немає зображень\n    } else {\n      renderGallery(images, true); // Додаємо нові зображення до галереї\n    }\n  } catch (error) {\n    iziToast.error({ message: \"Something went wrong. Please try again later.\" });\n  } finally {\n    hideLoader(); // Завжди ховаємо loader після завантаження\n  }\n});\n"],"names":["API_KEY","BASE_URL","page","totalHits","fetchImages","query","isNewSearch","response","axios","error","renderGallery","images","gallery","image","SimpleLightbox","form","loader","input","loadMoreBtn","loadedImages","showLoader","hideLoader","showLoadMoreBtn","hideLoadMoreBtn","event","iziToast","newTotalHits"],"mappings":"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"}